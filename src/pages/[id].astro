---
import BaseLayout from "../layouts/Layout.astro";
import { getCollection, render } from "astro:content";

// 1. Generate a new path for every collection entry
export async function getStaticPaths() {
  const posts = await getCollection("blog");
  return posts.map(post => ({
    params: { id: post.id },
    props: { post }
  }));
}

// 2. For your template, you can get the entry directly from the prop
const { post } = Astro.props;
const { Content } = await render(post);
---

<BaseLayout title={post.data.title}>
  <article class="max-w-3xl mx-auto">
    <header class="mb-8">
      <h1 class="text-4xl font-bold mb-4 text-gray-600 dark:text-gray-400">
        {post.data.title}
      </h1>
      <div class="flex gap-2 text-sm text-gray-500 items-center">
        <time>{post.data.date.toLocaleDateString()}</time>
        <span>â€¢</span>
        <div class="flex gap-2">
          {post.data.tags.map(tag => <span class="bg-gray-200 dark:bg-gray-700 px-2 py-1 rounded">#{tag}</span>)}
        </div>
      </div>
    </header>

    <div class="prose dark:prose-invert max-w-none">
      <Content />
    </div>

    <footer class="mt-12 pt-8 border-t border-gray-200 dark:border-gray-700">
      <a href="/blog" class="text-gray-600 dark:text-gray-400 hover:underline"> &larr; Back to Posts </a>
    </footer>
  </article>
</BaseLayout>
